<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <%= csrf_meta_tag %>
    <title><%= t(:site_title) -%> | <%= @page_title || controller.controller_name.capitalize %></title>
    <% unless @page_description.nil? && @page_title.nil? -%><meta name="description" content="<%= @page_description || @page_title %>" /><% end -%>

    <!-- load the common styles to all pages -->
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/style<%= language_suffix -%>.css" media="screen" />

    <!-- load the common scripts -->
    <%= javascript_include_tag 'http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js' %>
    <%= javascript_include_tag '/javascripts/jquery.qtip-1.0.0-rc3.min.js' %>
    <%= javascript_include_tag 'rails' %>

    <!-- load styles conditionally based on the controller name -->
    <% if controller.controller_name == 'exhibits' -%>
      <link rel="stylesheet" type="text/css" href="/stylesheets/facebox<%= language_suffix -%>.css" media="screen" />
      <script type="text/javascript" src="/javascripts/facebox.js" ></script>
      <script language="javascript" type="application/javascript">
        $(document).ready(function(){

        $('a[title]').qtip({
        style: {
        name: 'dark',
        tip: true,
        border: {
        radius: 8
        }
        },
        position: {
        corner: {
        target: 'topMiddle',
        tooltip: 'bottomMiddle'
        }
        }
        });

        });
      </script>
    <% elsif controller.controller_name == 'collections' -%>
      <link href="/stylesheets/dd<%= language_suffix -%>.css" media="screen" rel="stylesheet" type="text/css" />
      <script src="/javascripts/uncompressed.jquery.dd.js" type="text/javascript"></script>
      <script language="javascript" type="application/javascript">
        $(document).ready(function(){

        // click events for handling propper css classes sort buttons (A-Z / Date)
        $(".AZsort").click(function(){
        $(".AZsort").parent().siblings().removeClass("active");
        $(".AZsort").parent().addClass("active");
        $(".AZsort").parent().siblings().find("span").removeClass("up");
        $(".AZsort").find("span").toggleClass("up");
        return false;
        });

        $(".dateSort").click(function(){
        $(".dateSort").parent().siblings().removeClass("active");
        $(".dateSort").parent().addClass("active");
        $(".dateSort").parent().siblings().find("span").removeClass("up");
        $(".dateSort").find("span").toggleClass("up");
        return false;
        });

        // click events for handling propper css classes on "all items"/"my items" buttons
        $(".types li a").click(function(){
        $(this).parent().siblings().removeClass("active");
        $(this).parent().addClass("active");

        return false;
        });

        // fancy dropdowns for filters, and handling special cases
        $("#mediumFilter").msDropDown();
        $("#mediumFilter").change(function(){
        if ($(this).val() =="more") $("#browserFiltersDropdown").show("slide");
        else   $("#browserFiltersDropdown").hide("slide");
        });

        $("#browserFiltersDropdown .cancelButton ").click(function(){$("#browserFiltersDropdown").hide("slide");});

        $("#collectionFilter").msDropDown();
        $("#collectionFilter").change(function(){
        if ($(this).val() =="more") window.location = "generic.html"
        });
        $("#nameFilter").msDropDown();
        $("#nameFilter").change(function(){
        if ($(this).val() =="more") window.location = "generic.html"
        });
        $("#subjectFilter").msDropDown();
        $("#periodFilter").msDropDown();


        // tooltips
        $('a[title]').qtip({
        style: {
        name: 'dark',
        tip: true,
        border: {
        radius: 8
        }
        },
        position: {
        corner: {
        target: 'topMiddle',
        tooltip: 'bottomMiddle'
        }
        }
        });


        });
      </script>
    <% elsif controller.controller_name == 'home' -%>
      <script type="text/javascript" src="/javascripts/jquery.cycle.all.2.72.js"></script>
      <%= raw which_script? -%>
    <% else -%>
      <!-- a generic text page -->
      <script src="js/uncompressed.jquery.dd.js" type="text/javascript"></script>
      <script language="javascript" type="application/javascript">
        $(document).ready(function(){

        $(".types li a").click(function(){
        $(this).parent().siblings().removeClass("active").find("a").removeClass("active");
        $(this).parent().addClass("active");

        return false;
        });

        $("#mediumFilter").msDropDown();
        $("#mediumFilter").change(function(){
        if ($(this).val() =="more") $("#browserFiltersDropdown").show("slide");
        else   $("#browserFiltersDropdown").hide("slide");
        });

        $("#browserFiltersDropdown .cancelButton ").click(function(){$("#browserFiltersDropdown").hide("slide");});

        $("#collectionFilter").msDropDown();
        $("#collectionFilter").change(function(){
        if ($(this).val() =="more") window.location = "generic.html"
        });
        $("#nameFilter").msDropDown();
        $("#nameFilter").change(function(){
        if ($(this).val() =="more") window.location = "generic.html"
        });
        $("#subjectFilter").msDropDown();
        $("#periodFilter").msDropDown();

        $('a[title]').qtip({
        style: {
        name: 'dark',
        tip: true,
        border: {
        radius: 8
        }
        },
        position: {
        corner: {
        target: 'topMiddle',
        tooltip: 'bottomMiddle'
        }
        }
        });



        $("#browserFilters h4").click(function(){
        $("#browserFiltersDropdown").slideToggle();
        });

        });
      </script>
    <% end %>

  </head>
  <body>
    <div id="header">
      <div class="container">
        <h1><a href="/"><span><%=h t(:site_title) -%></span></a></h1>
        <div id="tools">
          <div id="search">
            <form action="" class="searchform" method="get">
              <input type="text" value="" name="s" class="swap_value" id="s"/>
              <button type="submit"></button>
            </form>
          </div>
          <ul>
            <li><%= link_to(t(:contact),contact_path) %></li>
            <li><%= link_to(t(:faq),faq_path) %></li>
          </ul>
        </div>
        <div id="nav">
          <a class="lang" href="<%=language_url-%>"><%= t(:language_option) -%></a>
          <ul class="sortnav">
            <li<% if controller.controller_name == 'home' -%> class="active"<% end -%>> <%= link_to(t(:home), home_path, { :class=>"module-link" }) %></li>
            <li<% if controller.controller_name == 'collections' -%> class="active"<% end -%>> <%= link_to(t(:collections), collections_path, { :class=>"module-link" }) %></li>
            <li<% if controller.controller_name == 'exhibits' -%> class="active"<% end -%>> <%= link_to(t(:exhibits), exhibits_path, { :class=>"module-link" }) %></li>
          </ul>
        </div>
      </div> <!-- end container -->
    </div> <!-- end header -->
    <div id="content" class="clearfix">
      <div class="container clearfix">

        <% if flash[:notice] -%><div class="notice"><%= flash[:notice] %></div><% end -%>
        <% if flash[:error] -%><div class="error"><%= flash[:error] %></div><% end -%>
        <%= yield :layout %>

      </div> <!-- end container -->
    </div><!-- end content -->
    <div id="pageFooterWrapper">
      <div id="pageFooter">
        <div class="columnWrapperFooter group">
          <div class="leftWrapperFooter">
            <ul class="footerNav">
              <li><%= link_to(t(:about),about_path) %></li>
              <li><%= link_to(t(:credits), credits_path) %></li>
              <li><%= link_to(t(:permissions),permissions_path) %></li>
            </ul>
            <p>Copyright Â© 2010  WWQI. <%= t(:all_rights_reserved)%></p>
          </div><!-- closes leftWrapperFooter -->
          <div class="rightWrapperFooter">
            <a class="noimage" href="http://www.harvard.edu" target="_blank"><img alt="Harvard Logo"  src="/images/harvard.gif"/></a>
            <ul class="footerNav">
              <li><a href="http://discovery.lib.harvard.edu/" target="_blank">HOLLIS <%= t(:catalog) %>  </a></li>
              <li><a href="http://www.fas.harvard.edu/~iohp/" target="_blank"><%= t(:iranian_oral_history_project) %></a></li>
              <li><a href="http://via.lib.harvard.edu/via/deliver/advancedsearch?_collection=via" target="_blank">VIA <%= t(:visual_resources) %></a></li>
              <li><a href="http://ocp.hul.harvard.edu/ihp/" target="_blank"><%= t(:islamic_heritage_project) %></a></li>
              <li><a href="http://oasis.lib.harvard.edu/oasis/deliver/advancedsearch?_collection=oasis" target="_blank">OASIS <%= t(:archival_finding_aids) %></a></li>
              <li><a href="http://pds.lib.harvard.edu/pds/view/6665026?n=1&imagesize=1200&jp2Res=.125" target="_blank"><%= t(:ali_khan_album) %></a></li>
            </ul>
          </div><!-- closes rightWrapperFooter -->
        </div><!-- closes columnWrapperFooter group -->


      </div>
    </div>

    <%= raw google_analytics_block -%>

  </body>
</html>
